@page "/register-team/{email}"

@inject ISnackbar Snackbar

<div class="team-registration-page" style="background:linear-gradient(145deg,#0b132b,#111a33);min-height:100vh;padding:3rem;">
    <MudContainer MaxWidth="MaxWidth.Large">

        <div class="registration-header" style="text-align:center;margin-bottom:2rem;">
            <MudText Typo="Typo.h3"
                     Style="color:#10b981;font-weight:800;letter-spacing:1px;text-transform:uppercase;">
                Team Registration
            </MudText>
            <MudText Typo="Typo.body1"
                     Style="color:#94a3b8;font-size:1rem;margin-top:0.5rem;">
                Register your team for the African Nations League 2026
            </MudText>
        </div>

        <MudCard Style="background-color:#1c2541;border-radius:14px;padding:2rem;box-shadow:0 6px 25px rgba(0,0,0,0.5);border:1px solid #334155;color:#e2e8f0;">
            <MudCardContent>

                <MudStepper @ref="stepper" Color="Color.Success">

                    <!-- Step 1: Team Information -->
                    <MudStep Title="Team Information" Style="color:white;">
                        <MudAlert Severity="Severity.Info" Variant="Variant.Outlined"
                                  Style="background-color:#0f172a;border-left:4px solid #3b82f6;color:#93c5fd;margin-bottom:1rem;">
                            Please provide your team information to begin registration.
                        </MudAlert>

                        <MudGrid Style="margin-top:1rem;">
                            <MudItem xs="12" md="6">
                                <MudSelect @bind-Value="SelectedCountry" Variant="Variant.Outlined" Clearable Style="color:white;" Placeholder="Your country">
                                    @foreach (var country in countries)
                                    {
                                        <MudSelectItem Value="@country.Code">
                                            <img src="@country.FlagUrl" alt="@country.Name flag" style="height:16px;vertical-align:middle;margin-right:8px;" />
                                            @country.Name
                                        </MudSelectItem>
                                    }
                                </MudSelect>
                            </MudItem>

                            <MudItem xs="12" md="6">
                                <MudTextField @bind-Value="managerName"
                                              Placeholder="Head Coach full name"
                                              Variant="Variant.Outlined"
                                              Required="true"
                                              Style="background-color:#0f172a;border-radius:8px;border:1px solid #334155;" />
                            </MudItem>

                            <MudItem xs="12">
                                <MudTextField @bind-Value="email"
                                              Placeholder="Federation Representative "
                                              Variant="Variant.Outlined"
                                              Required="true"
                                              ReadOnly="true"
                                              Style="background-color:#0f172a;border-radius:8px;border:1px solid #334155;" />
                            </MudItem>
                        </MudGrid>

                    
                    </MudStep>

                    <!-- Step 2: Squad Selection -->
                    <MudStep Title="Build Squad (23 Players)">
                        <MudAlert Severity="Severity.Info"
                                  Style="background-color:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;color:#93c5fd;margin-bottom:1rem;">
                            Click "Auto-Generate Squad" to automatically create 23 players with ratings, or add players manually.
                        </MudAlert>


                        <MudButton Variant="Variant.Filled" Color="Color.Success"
                                   StartIcon="@Icons.Material.Filled.AutoAwesome"
                                   OnClick="AutoGenerateSquadAsync"
                                   Style="background-color:#10b981;color:white;font-weight:600;border-radius:8px;box-shadow:0 4px 10px rgba(16,185,129,0.3);margin-bottom:1rem;">
                            Auto-Generate Squad
                        </MudButton>

                        <MudText Typo="Typo.h6" Style="color:#10b981;margin-bottom:0.75rem;">
                            Squad: @players.Count / 23 Players
                        </MudText>

                        @if (players.Any())
                        {
                            <MudGrid>
                                @foreach (var position in new[] { "GK", "DF", "MD", "AT" })
                                {
                                    <MudItem xs="12" md="6">
                                        <MudCard Style="background-color:#0f172a;border:1px solid #334155;border-radius:10px;padding:1rem;margin-bottom:1rem;transition:all .3s ease;">
                                            <MudCardHeader>
                                                <CardHeaderContent>
                                                    <MudText Typo="Typo.h6" Style="color:#10b981;">@GetPositionName(position)</MudText>
                                                </CardHeaderContent>
                                            </MudCardHeader>
                                            <MudCardContent>
                                                @foreach (var player in players.Where(p => p.NaturalPosition == position))
                                                {
                                                    <div style="background-color:#1e293b;border:1px solid #334155;border-radius:8px;padding:0.75rem;margin-bottom:0.5rem;color:#e2e8f0;transition:all .3s ease;">
                                                        <div style="display:flex;justify-content:space-between;align-items:center;">
                                                            <strong>@player.Name</strong>
                                                            @if (player.IsCaptain)
                                                            {
                                                                <MudChip T="string" Size="Size.Small" Color="Color.Warning">Captain</MudChip>
                                                            }
                                                        </div>
                                                        <div style="display:flex;gap:0.5rem;font-size:0.85rem;color:#94a3b8;margin-top:0.5rem;">
                                                            <span style="background:rgba(16,185,129,0.15);color:#10b981;padding:0.25rem 0.5rem;border-radius:4px;">GK: @player.GKRating</span>
                                                            <span style="background:rgba(16,185,129,0.15);color:#10b981;padding:0.25rem 0.5rem;border-radius:4px;">DF: @player.DFRating</span>
                                                            <span style="background:rgba(16,185,129,0.15);color:#10b981;padding:0.25rem 0.5rem;border-radius:4px;">MD: @player.MDRating</span>
                                                            <span style="background:rgba(16,185,129,0.15);color:#10b981;padding:0.25rem 0.5rem;border-radius:4px;">AT: @player.ATRating</span>
                                                        </div>
                                                    </div>
                                                }
                                            </MudCardContent>
                                        </MudCard>
                                    </MudItem>
                                }
                            </MudGrid>

                            <MudAlert Severity="Severity.Success"
                                      Style="background-color:rgba(16,185,129,0.15);border-left:4px solid #10b981;color:#6ee7b7;margin-top:1rem;">
                                Team Rating: <strong>@CalculateTeamRating()</strong>
                            </MudAlert>
                        }

                    </MudStep>

                    <!-- Step 3: Confirm -->
                    <MudStep Title="Confirm Registration">
                        <MudAlert Severity="Severity.Info"
                                  Style="background-color:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;color:#93c5fd;margin-bottom:1rem;">
                            Review your team details before submitting.
                        </MudAlert>

                        <MudSimpleTable Style="width:100%;border-radius:8px;background-color:#0f172a;color:#e2e8f0;margin-bottom:1rem;">
                            <tbody>
                                <tr><td><strong>Country:</strong></td><td>@SelectedCountry</td></tr>
                                <tr><td><strong>Manager:</strong></td><td>@managerName</td></tr>
                                <tr><td><strong>Representative:</strong></td><td>@email</td></tr>
                                <tr><td><strong>Squad Size:</strong></td><td>@players.Count players</td></tr>
                                <tr><td><strong>Team Rating:</strong></td><td>@CalculateTeamRating()</td></tr>
                            </tbody>
                        </MudSimpleTable>

                        <MudStep Title="Confirm Registration">
                            <!-- ...other markup... -->
                            <MudButton Variant="Variant.Filled" Color="Color.Success" FullWidth="true" Size="Size.Large"
                                       StartIcon="@Icons.Material.Filled.CheckCircle"
                                       OnClick="SubmitRegistration"
                                       Style="background-color:#10b981;color:white;font-weight:700;border:none;border-radius:8px;box-shadow:0 6px 16px rgba(16,185,129,0.35);margin-top:1.5rem;">
                                Complete Registration
                            </MudButton>
                        </MudStep>

                    </MudStep>
                </MudStepper>
            </MudCardContent>
        </MudCard>
    </MudContainer>
</div>




<style>
    /* Premium Team Registration Page - Enterprise Grade Styling */

    :root {
        --bg-primary: #050810;
        --bg-secondary: #0f1419;
        --bg-tertiary: #1a2332;
        --bg-hover: #242f3f;
        --border-primary: #2d3b52;
        --border-subtle: #1a2332;
        --text-primary: #ffffff;
        --text-secondary: #a0aac0;
        --text-tertiary: #64748b;
        --accent-cyan: #00d9ff;
        --accent-blue: #3b82f6;
        --accent-gold: #fbbf24;
        --accent-success: #10b981;
        --accent-error: #ef4444;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    html, body {
        background: linear-gradient(to bottom, var(--bg-primary) 0%, var(--bg-secondary) 100%);
        color: var(--text-primary);
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        min-height: 100vh;
    }

    .team-registration-page {
        background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%) !important;
        min-height: 100vh !important;
        padding: 2.5rem 2rem !important;
    }

    /* Registration Header */
    .registration-header {
        text-align: center;
        margin-bottom: 3rem;
    }

        .registration-header h3 {
            font-size: 2.75rem;
            font-weight: 900;
            color: var(--accent-cyan) !important;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            line-height: 1.2;
            margin: 0 !important;
        }

        .registration-header p {
            color: var(--text-secondary) !important;
            font-size: 1.05rem;
            margin-top: 0.75rem !important;
            font-weight: 400;
            letter-spacing: 0.3px;
        }

    /* Main Card Container */
    .mud-card {
        background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%) !important;
        border: 1.5px solid var(--border-primary) !important;
        border-radius: 14px !important;
        padding: 3rem !important;
        box-shadow: 0 20px 60px rgba(0, 217, 255, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.08) !important;
        color: var(--text-primary) !important;
        transition: all 0.3s ease;
    }

        .mud-card:hover {
            border-color: rgba(0, 217, 255, 0.2) !important;
            box-shadow: 0 20px 60px rgba(0, 217, 255, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.08) !important;
        }

    .mud-card-content {
        color: var(--text-primary) !important;
        padding: 0 !important;
    }

    /* Stepper Styling */
    .mud-stepper {
        background: transparent !important;
        color: var(--text-primary) !important;
    }

    :deep(.mud-stepper .mud-step-label) {
        color: var(--text-secondary) !important;
        font-weight: 600;
        transition: all 0.3s ease;
    }

    :deep(.mud-stepper .mud-step.active .mud-step-label) {
        color: var(--accent-cyan) !important;
        font-weight: 800;
    }

    :deep(.mud-stepper .mud-stepper-nav .mud-step-icon) {
        background-color: var(--accent-success) !important;
        color: white !important;
        box-shadow: 0 0 16px rgba(16, 185, 129, 0.4) !important;
        width: 48px !important;
        height: 48px !important;
        font-weight: 800;
    }

    :deep(.mud-stepper .mud-step.active .mud-step-icon) {
        background-color: var(--accent-cyan) !important;
        box-shadow: 0 0 20px rgba(0, 217, 255, 0.5) !important;
    }

    :deep(.mud-stepper-nav) {
        border-bottom: 2px solid var(--border-primary) !important;
        padding-bottom: 2rem !important;
        margin-bottom: 2rem !important;
    }

    :deep(.mud-step-label-content) {
        font-size: 0.95rem !important;
        font-weight: 700 !important;
        letter-spacing: 0.05em !important;
        text-transform: uppercase !important;
    }

    /* Alert Styling */
    :deep(.mud-alert) {
        border-radius: 10px !important;
        padding: 1.25rem !important;
        margin-bottom: 1.75rem !important;
        font-weight: 500;
        border: 1.5px solid !important;
        backdrop-filter: blur(8px);
    }

    :deep(.mud-alert.severity-info) {
        background-color: rgba(59, 130, 246, 0.15) !important;
        border-color: rgba(59, 130, 246, 0.3) !important;
        color: #93c5fd !important;
    }

    :deep(.mud-alert.severity-success) {
        background-color: rgba(16, 185, 129, 0.15) !important;
        border-color: rgba(16, 185, 129, 0.3) !important;
        color: #6ee7b7 !important;
    }

    :deep(.mud-alert.severity-warning) {
        background-color: rgba(245, 158, 11, 0.15) !important;
        border-color: rgba(245, 158, 11, 0.3) !important;
        color: #fbbf24 !important;
    }

    :deep(.mud-alert-left-icon) {
        color: inherit !important;
    }

    /* Grid Layout */
    .mud-grid {
        gap: 1.5rem !important;
        margin-top: 1.5rem !important;
    }

    .mud-item {
        padding: 0 !important;
    }

    /* Input Fields */
    :deep(.mud-text-field) {
        width: 100%;
    }

    :deep(.mud-input-outlined) {
        background-color: var(--bg-secondary) !important;
        border-radius: 10px !important;
        border: 1.5px solid var(--border-primary) !important;
        transition: all 0.3s ease !important;
    }

    :deep(.mud-input) {
        color: var(--text-primary) !important;
        font-size: 1rem;
        font-weight: 500;
    }

    :deep(.mud-input::placeholder) {
        color: var(--text-tertiary) !important;
    }

    :deep(.mud-input-outlined:hover) {
        border-color: rgba(0, 217, 255, 0.4) !important;
        background-color: var(--bg-tertiary) !important;
    }

    :deep(.mud-input-outlined.mud-focused) {
        border-color: var(--accent-cyan) !important;
        box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.15) !important;
        background-color: var(--bg-tertiary) !important;
    }

    /* Select Dropdown */
    :deep(.mud-select-outlined) {
        background-color: var(--bg-secondary) !important;
        border-radius: 10px !important;
        border: 1.5px solid var(--border-primary) !important;
        transition: all 0.3s ease !important;
    }

    :deep(.mud-select-outlined:hover) {
        border-color: rgba(0, 217, 255, 0.4) !important;
    }

    :deep(.mud-select-outlined.mud-focused) {
        border-color: var(--accent-cyan) !important;
        box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.15) !important;
    }

    :deep(.mud-select-item) {
        background-color: var(--bg-secondary) !important;
        color: var(--text-primary) !important;
    }

    :deep(.mud-select-item:hover) {
        background-color: var(--bg-tertiary) !important;
    }

    /* Label Styling */
    :deep(.mud-input-label) {
        color: var(--text-secondary) !important;
        font-weight: 700 !important;
        font-size: 0.9rem !important;
        text-transform: uppercase !important;
        letter-spacing: 0.08em !important;
    }

    /* Buttons */
    :deep(.mud-button-root) {
        font-weight: 800 !important;
        letter-spacing: 0.06em !important;
        text-transform: uppercase !important;
        transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
        border-radius: 10px !important;
        position: relative;
        overflow: hidden;
    }

    :deep(.mud-button-filled) {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
    }

    :deep(.mud-button-filled-success) {
        background-color: var(--accent-success) !important;
        color: white !important;
        box-shadow: 0 12px 32px rgba(16, 185, 129, 0.3) !important;
    }

    :deep(.mud-button-filled-success:hover:not(:disabled)) {
        background-color: #059669 !important;
        box-shadow: 0 16px 40px rgba(16, 185, 129, 0.4) !important;
        transform: translateY(-3px);
    }

    :deep(.mud-button-filled-success:active:not(:disabled)) {
        transform: translateY(-1px);
    }

    :deep(.mud-button-filled-success:disabled) {
        background-color: var(--bg-hover) !important;
        color: var(--text-tertiary) !important;
        opacity: 0.6;
    }

    :deep(.mud-button-filled-primary) {
        background-color: var(--accent-cyan) !important;
        color: var(--bg-primary) !important;
        box-shadow: 0 12px 32px rgba(0, 217, 255, 0.3) !important;
        font-weight: 800;
    }

    :deep(.mud-button-filled-primary:hover:not(:disabled)) {
        background-color: #00b8d4 !important;
        box-shadow: 0 16px 40px rgba(0, 217, 255, 0.4) !important;
        transform: translateY(-3px);
    }

    :deep(.mud-button-text) {
        color: var(--accent-cyan) !important;
        font-weight: 700;
    }

    :deep(.mud-button-text:hover) {
        background-color: rgba(0, 217, 255, 0.1) !important;
    }

    /* Squad Section */
    .squad-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 2rem;
        flex-wrap: wrap;
        gap: 1rem;
    }

    .squad-count {
        font-size: 1.25rem;
        font-weight: 800;
        color: var(--accent-cyan);
        letter-spacing: 0.05em;
    }

    /* Position Group Cards */
    :deep(.mud-card) {
        background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%) !important;
        border: 1px solid var(--border-primary) !important;
        border-radius: 10px !important;
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
        margin-bottom: 1.5rem;
    }

    :deep(.mud-card:hover) {
        border-color: var(--accent-cyan);
        transform: translateY(-6px);
        box-shadow: 0 12px 32px rgba(0, 217, 255, 0.15) !important;
    }

    :deep(.mud-card-header) {
        padding: 1.5rem !important;
        border-bottom: 1px solid var(--border-primary) !important;
        background: linear-gradient(135deg, rgba(26, 35, 50, 0.5) 0%, rgba(15, 20, 25, 0.5) 100%);
    }

    :deep(.mud-card-header h6) {
        color: var(--accent-cyan) !important;
        font-weight: 800 !important;
        letter-spacing: 0.05em !important;
        text-transform: uppercase !important;
        font-size: 1.1rem;
        margin: 0 !important;
    }

    :deep(.mud-card-content) {
        padding: 1.5rem !important;
    }

    /* Player Card Mini */
    .player-card-mini {
        background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
        border: 1px solid var(--border-primary);
        border-radius: 10px;
        padding: 1.25rem;
        margin-bottom: 1rem;
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
    }

        .player-card-mini:hover {
            border-color: var(--accent-cyan);
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 217, 255, 0.15);
        }

    .player-name {
        font-weight: 700;
        color: var(--text-primary);
        font-size: 1.05rem;
        letter-spacing: -0.01em;
    }

    .player-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        margin-bottom: 0.75rem;
    }

    .player-ratings {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-top: 0.75rem;
    }

    .rating-badge {
        background: rgba(0, 217, 255, 0.15);
        color: var(--accent-cyan);
        padding: 0.375rem 0.75rem;
        border-radius: 6px;
        font-weight: 800;
        font-size: 0.75rem;
        letter-spacing: 0.08em;
        border: 1px solid rgba(0, 217, 255, 0.2);
        text-transform: uppercase;
    }

    /* Chip Styling */
    :deep(.mud-chip) {
        background-color: rgba(245, 158, 11, 0.2) !important;
        color: var(--accent-gold) !important;
        font-weight: 800 !important;
        font-size: 0.75rem !important;
        letter-spacing: 0.08em !important;
        text-transform: uppercase !important;
    }

    /* Confirmation Table */
    :deep(.mud-simple-table) {
        background-color: var(--bg-secondary) !important;
        border: 1px solid var(--border-primary) !important;
        border-radius: 10px !important;
        overflow: hidden;
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }

    :deep(.mud-table tbody tr) {
        border-bottom: 1px solid var(--border-primary) !important;
        transition: background-color 0.2s ease;
    }

    :deep(.mud-table tbody tr:hover) {
        background-color: rgba(0, 217, 255, 0.08) !important;
    }

    :deep(.mud-table tbody tr:last-child) {
        border-bottom: none !important;
    }

    :deep(.mud-table td) {
        padding: 1.25rem !important;
        color: var(--text-primary) !important;
        font-weight: 500;
    }

    :deep(.mud-table strong) {
        color: var(--accent-cyan);
        font-weight: 800;
    }

    /* Responsive Design */
    @@media (max-width: 1024px) {
        .team-registration-page

    {
        padding: 2rem 1.5rem !important;
    }

    .mud-card {
        padding: 2.5rem !important;
    }

    .registration-header h3 {
        font-size: 2.25rem;
    }

    }

    @@media (max-width: 768px) {
        .team-registration-page

    {
        padding: 1.5rem 1rem !important;
    }

    .mud-card {
        padding: 2rem !important;
        border-radius: 12px !important;
    }

    .registration-header h3 {
        font-size: 2rem;
    }

    :deep(.mud-grid) {
        gap: 1rem !important;
    }

    .mud-item {
        min-width: 100% !important;
    }

    :deep(.mud-button-root) {
        width: 100% !important;
    }

    .player-card-mini {
        flex-direction: column;
        align-items: flex-start;
        padding: 1rem;
    }

    .player-info {
        width: 100%;
    }

    }

   @@media (max-width: 480px) {
        .team-registration-page

    {
        padding: 1rem !important;
    }

    .mud-card {
        padding: 1.5rem !important;
        border-radius: 10px !important;
    }

    .registration-header h3 {
        font-size: 1.5rem;
    }

    .registration-header p {
        font-size: 0.95rem;
    }

    :deep(.mud-stepper-nav) {
        padding-bottom: 1.5rem !important;
        margin-bottom: 1.5rem !important;
    }

    :deep(.mud-step-label-content) {
        font-size: 0.8rem !important;
    }

    .squad-count {
        font-size: 1rem;
    }

    .player-ratings {
        gap: 0.375rem;
    }

    .rating-badge {
        padding: 0.25rem 0.5rem;
        font-size: 0.7rem;
    }

    }
</style>

